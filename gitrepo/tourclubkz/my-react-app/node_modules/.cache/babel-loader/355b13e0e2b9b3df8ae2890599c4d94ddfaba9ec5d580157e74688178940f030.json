{"ast":null,"code":"var _jsxFileName = \"/Applications/MAMP/htdocs/tourclubkz/my-react-app/src/lessonpdf.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useParams, useNavigate, Link } from 'react-router-dom';\nimport Navpanmini from './navpanmini';\nimport { jwtDecode } from 'jwt-decode';\n//CSS lessonlistpanel.css\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Lessonpdf() {\n  _s();\n  const navigate = useNavigate(); // Используйте useNavigate\n  const {\n    title\n  } = useParams();\n  const titleWithSpaces = title.replace(/-/g, ' ');\n  const {\n    lesson\n  } = useParams();\n  const lessonWithSpaces = lesson.replace(/-/g, ' ');\n  const [responseData, setResponseData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const token = localStorage.getItem('token');\n  let decoded = jwtDecode(token);\n  let user_id = decoded.sub;\n  useEffect(() => {\n    const checkResultAndShowVideo = async () => {\n      console.log(user_id);\n      try {\n        const checkResultResponse = await fetch(`${BASE_URL}tourschoolphp/Checkresulttoshowvideo.php`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            user_id: user_id,\n            title: lessonWithSpaces,\n            course: titleWithSpaces\n          })\n        });\n        if (!checkResultResponse.ok) {\n          throw new Error('Ошибка при проверке результата для отображения видео');\n        }\n        const checkResultData = await checkResultResponse.json();\n\n        // Check if checkResultData is an array before accessing its elements\n        if (Array.isArray(checkResultData) && checkResultData.length > 0) {\n          // Вывод данных из PHP-скрипта в консоль\n          console.log('Response from PHP script:', checkResultData);\n\n          // Извлекаем значение available_at из первого элемента массива\n          const availableAt = checkResultData[0].available_at;\n          console.log('available_at:', availableAt);\n\n          // Получаем текущее время клиента\n          const clientTime = new Date();\n\n          // Получаем время с сервера и преобразуем его в объект Date (время сервера считаем в UTC)\n          const serverTimeUTC = new Date(availableAt);\n\n          // Получаем смещение временной зоны клиента\n          const clientTimezoneOffset = clientTime.getTimezoneOffset();\n\n          // Корректируем время сервера на смещение временной зоны клиента\n          const serverTime = new Date(serverTimeUTC.getTime() - clientTimezoneOffset * 60000);\n          console.log(serverTimeUTC);\n\n          // Сравниваем время с сервера и времени клиента\n          if (serverTime > clientTime) {\n            // Если время на сервере больше времени клиента, выполняем перенаправление\n            navigate('/courses');\n          } else {}\n        }\n      } catch (error) {\n        // console.error('Ошибка при проверке результата для отображения видео:', error);\n      }\n    };\n    checkResultAndShowVideo();\n  }, [user_id, lessonWithSpaces, titleWithSpaces]);\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await fetch(`${BASE_URL}tourschoolphp/lessonvideo.php`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            lesson: lessonWithSpaces,\n            course: titleWithSpaces\n          })\n        });\n        if (!response.ok) {\n          throw new Error('Ошибка при запросе данных');\n        }\n        const responseBody = await response.text();\n        const data = JSON.parse(responseBody);\n        setResponseData(data);\n      } catch (error) {\n        console.error('Ошибка при отправке запроса:', error);\n      } finally {\n        // Устанавливаем статус загрузки в false после завершения запроса\n        setLoading(false);\n      }\n    };\n    fetchData();\n  }, [titleWithSpaces]);\n  console.log(responseData);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"containerfortextlesson\",\n    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n      className: \"form7\",\n      src: \"/form7.svg\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"titlefortextlesson\",\n      children: lessonWithSpaces\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fileinfo\",\n      children: \"\\u0418\\u0437\\u0443\\u0447\\u0438\\u0442\\u0435 \\u0444\\u0430\\u0439\\u043B, \\u0432\\u044B\\u043F\\u0438\\u0448\\u0438\\u0442\\u0435 \\u0441\\u0430\\u043C\\u043E\\u0435 \\u0433\\u043B\\u0430\\u0432\\u043D\\u043E\\u0435\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fileinfo\",\n      children: \"\\u0417\\u0430\\u0442\\u0435\\u043C \\u043F\\u0440\\u043E\\u0439\\u0434\\u0438\\u0442\\u0435 \\u0442\\u0435\\u0441\\u0442\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n      className: \"filetext\",\n      href: `${BASE_URL}tourschoolphp/${responseData}`,\n      download: true,\n      children: \"\\u0421\\u043A\\u0430\\u0447\\u0430\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Link, {\n      to: `/courses/${title}/${lesson}/finaltest`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"filetest\",\n        children: \"\\u041F\\u0440\\u043E\\u0439\\u0442\\u0438 \\u0442\\u0435\\u0441\\u0442\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 1\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(Navpanmini, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 1\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 1\n  }, this);\n}\n_s(Lessonpdf, \"juXRu8c4wtspxS/z9oX/IE4xJpw=\", false, function () {\n  return [useNavigate, useParams, useParams];\n});\n_c = Lessonpdf;\nexport default Lessonpdf;\nvar _c;\n$RefreshReg$(_c, \"Lessonpdf\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useParams","useNavigate","Link","Navpanmini","jwtDecode","jsxDEV","_jsxDEV","Lessonpdf","_s","navigate","title","titleWithSpaces","replace","lesson","lessonWithSpaces","responseData","setResponseData","loading","setLoading","token","localStorage","getItem","decoded","user_id","sub","checkResultAndShowVideo","console","log","checkResultResponse","fetch","BASE_URL","method","headers","body","JSON","stringify","course","ok","Error","checkResultData","json","Array","isArray","length","availableAt","available_at","clientTime","Date","serverTimeUTC","clientTimezoneOffset","getTimezoneOffset","serverTime","getTime","error","fetchData","response","responseBody","text","data","parse","className","children","src","fileName","_jsxFileName","lineNumber","columnNumber","href","download","to","_c","$RefreshReg$"],"sources":["/Applications/MAMP/htdocs/tourclubkz/my-react-app/src/lessonpdf.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useParams, useNavigate, Link } from 'react-router-dom';\nimport Navpanmini from './navpanmini';\nimport { jwtDecode } from 'jwt-decode';\n//CSS lessonlistpanel.css\nfunction Lessonpdf() {\n    \n    const navigate = useNavigate(); // Используйте useNavigate\n    const { title } = useParams();\n    const titleWithSpaces = title.replace(/-/g, ' ');\n    const { lesson } = useParams();\n    const lessonWithSpaces = lesson.replace(/-/g, ' ');\n    const [responseData, setResponseData] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const token = localStorage.getItem('token');\n\n\nlet decoded = jwtDecode(token);\n\nlet user_id = decoded.sub;\n    useEffect(() => {\n        const checkResultAndShowVideo = async () => {\n          console.log(user_id);\n      \n          try {\n            const checkResultResponse = await fetch(`${BASE_URL}tourschoolphp/Checkresulttoshowvideo.php`, {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json',\n              },\n              body: JSON.stringify({\n                user_id: user_id,\n                title: lessonWithSpaces,\n                course: titleWithSpaces,\n              }),\n            });\n      \n            if (!checkResultResponse.ok) {\n              throw new Error('Ошибка при проверке результата для отображения видео');\n            }\n      \n            const checkResultData = await checkResultResponse.json();\n      \n            // Check if checkResultData is an array before accessing its elements\n            if (Array.isArray(checkResultData) && checkResultData.length > 0) {\n              // Вывод данных из PHP-скрипта в консоль\n              console.log('Response from PHP script:', checkResultData);\n      \n              // Извлекаем значение available_at из первого элемента массива\n              const availableAt = checkResultData[0].available_at;\n              console.log('available_at:', availableAt);\n      \n              // Получаем текущее время клиента\n              const clientTime = new Date();\n      \n              // Получаем время с сервера и преобразуем его в объект Date (время сервера считаем в UTC)\n              const serverTimeUTC = new Date(availableAt);\n      \n              // Получаем смещение временной зоны клиента\n              const clientTimezoneOffset = clientTime.getTimezoneOffset();\n      \n              // Корректируем время сервера на смещение временной зоны клиента\n              const serverTime = new Date(serverTimeUTC.getTime() - clientTimezoneOffset * 60000);\n              console.log(serverTimeUTC);\n      \n              // Сравниваем время с сервера и времени клиента\n              if (serverTime > clientTime) {\n                // Если время на сервере больше времени клиента, выполняем перенаправление\n                navigate('/courses');\n              } else {\n           \n              }\n            } \n          } catch (error) {\n            // console.error('Ошибка при проверке результата для отображения видео:', error);\n          }\n        };\n      \n        checkResultAndShowVideo();\n      }, [user_id, lessonWithSpaces, titleWithSpaces]);\n      \n   useEffect(() => {\n        const fetchData = async () => {\n          try {\n            const response = await fetch(`${BASE_URL}tourschoolphp/lessonvideo.php`, {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json',\n              },\n              body: JSON.stringify({ lesson: lessonWithSpaces, course: titleWithSpaces }),\n            });\n      \n            if (!response.ok) {\n              throw new Error('Ошибка при запросе данных');\n            }\n      \n            const responseBody = await response.text();\n            const data = JSON.parse(responseBody);\n            setResponseData(data);\n          } catch (error) {\n            console.error('Ошибка при отправке запроса:', error);\n          } finally {\n            // Устанавливаем статус загрузки в false после завершения запроса\n            setLoading(false);\n        }\n    };\n    fetchData();\n}, [titleWithSpaces]);\nconsole.log(responseData);\n return (\n\n<div className=\"containerfortextlesson\">\n<img className='form7' src='/form7.svg'></img>\n<div className=\"titlefortextlesson\">{lessonWithSpaces}</div>\n<div className=\"fileinfo\">Изучите файл, выпишите самое главное</div>\n<div className=\"fileinfo\">Затем пройдите тест</div>\n\n    <a className='filetext' href={`${BASE_URL}tourschoolphp/${responseData}`} download>Скачать файл</a>\n\n\n\n<Link to={`/courses/${title}/${lesson}/finaltest`}>\n<div className=\"filetest\">Пройти тест</div>\n</Link>\n<Navpanmini/>\n</div>\n    \n )   \n}\nexport default Lessonpdf;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}