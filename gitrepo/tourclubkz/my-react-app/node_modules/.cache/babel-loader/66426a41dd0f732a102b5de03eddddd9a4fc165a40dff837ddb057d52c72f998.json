{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{BASE_URL}from'./config';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";function BlockUser(_ref){var _value4$,_value2$,_value4$2,_value3$;let{value1,value2,value3,value4}=_ref;const[isModalOpen,setIsModalOpen]=useState(false);const[blockReason,setBlockReason]=useState('');const handleBlockClick=()=>{setIsModalOpen(true);};const handleCloseModal=()=>{setIsModalOpen(false);};const handleBlockUser=async()=>{console.log(value1);try{// Отправляем измененные данные на сервер\nconst response=await fetch(\"\".concat(BASE_URL,\"tourschoolphp/Blockuser.php\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({user:value1,curatorid:value2,blockReason:blockReason// Use blockReason directly from state\n})});const newData=await response.json();}catch(error){console.error('Ошибка при сохранении данных:',error);}setIsModalOpen(false);window.location.reload();};const handleUnblockUser=async()=>{try{const response=await fetch(\"\".concat(BASE_URL,\"tourschoolphp/Unblockuser.php\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({user:value1,curatorid:value2})});const newData=await response.json();}catch(error){console.error('Ошибка при разблокировке пользователя:',error);}setIsModalOpen(false);window.location.reload();};const isCurator=((_value4$=value4[0])===null||_value4$===void 0?void 0:_value4$.role)==='curator';const isCurrentUserCurator=((_value2$=value2[0])===null||_value2$===void 0?void 0:_value2$.curator)===value3;const isAdmin=((_value4$2=value4[0])===null||_value4$2===void 0?void 0:_value4$2.role)==='admin';const isUserBlocked=((_value3$=value3[0])===null||_value3$===void 0?void 0:_value3$.user_exists_in_blocks)===1;return/*#__PURE__*/_jsxs(_Fragment,{children:[!isUserBlocked&&isCurrentUserCurator||isAdmin&&!isUserBlocked&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{className:\"redactirovat\",onClick:handleBlockClick,children:\"\\u0417\\u0430\\u0431\\u043B\\u043E\\u043A\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"})}),isUserBlocked&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"blocked-message2\",children:\"\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C \\u0437\\u0430\\u0431\\u043B\\u043E\\u043A\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\"}),/*#__PURE__*/_jsxs(\"h1\",{className:\"blocked-message2\",children:[\"\\u041F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430: \",value3[0].block_reason]})]}),isUserBlocked&&isAdmin&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{className:\"redactirovat2\",onClick:handleBlockClick,children:\"\\u0420\\u0430\\u0437\\u0431\\u043B\\u043E\\u043A\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"})}),isModalOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal3\",children:isAdmin&&isUserBlocked?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B, \\u0447\\u0442\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u0440\\u0430\\u0437\\u0431\\u043B\\u043E\\u043A\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F?\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCloseModal,children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleUnblockUser,children:\"\\u0420\\u0430\\u0437\\u0431\\u043B\\u043E\\u043A\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B, \\u0447\\u0442\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u0437\\u0430\\u0431\\u043B\\u043E\\u043A\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F?\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0443 \\u0431\\u043B\\u043E\\u043A\\u0438\\u0440\\u043E\\u0432\\u043A\\u0438\",onChange:e=>setBlockReason(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCloseModal,children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleBlockUser,children:\"\\u0417\\u0430\\u0431\\u043B\\u043E\\u043A\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"})]})})})]});}export default BlockUser;","map":{"version":3,"names":["React","useState","useEffect","BASE_URL","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","BlockUser","_ref","_value4$","_value2$","_value4$2","_value3$","value1","value2","value3","value4","isModalOpen","setIsModalOpen","blockReason","setBlockReason","handleBlockClick","handleCloseModal","handleBlockUser","console","log","response","fetch","concat","method","headers","body","JSON","stringify","user","curatorid","newData","json","error","window","location","reload","handleUnblockUser","isCurator","role","isCurrentUserCurator","curator","isAdmin","isUserBlocked","user_exists_in_blocks","children","className","onClick","block_reason","type","placeholder","onChange","e","target","value"],"sources":["/Applications/MAMP/htdocs/gitrepo/tourclubkz/my-react-app/src/redactstudentinfo.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { BASE_URL } from './config';\nfunction BlockUser({ value1, value2, value3, value4 }) {\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [blockReason, setBlockReason] = useState('');\n    const handleBlockClick = () => {\n        setIsModalOpen(true);\n    };\n\n    const handleCloseModal = () => {\n        setIsModalOpen(false);\n    };\n    const handleBlockUser = async () => {\n        console.log(value1);\n        try {\n            // Отправляем измененные данные на сервер\n            const response = await fetch(`${BASE_URL}tourschoolphp/Blockuser.php`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    user: value1,\n                    curatorid: value2,\n                    blockReason: blockReason, // Use blockReason directly from state\n                }),\n            });\n    \n            const newData = await response.json();\n    \n    \n        } catch (error) {\n            console.error('Ошибка при сохранении данных:', error);\n        }\n        setIsModalOpen(false);\n        window.location.reload();\n    };\n\n    const handleUnblockUser = async () => {\n        try {\n            const response = await fetch(`${BASE_URL}tourschoolphp/Unblockuser.php`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    user: value1,\n                    curatorid: value2,\n                }),\n            });\n    \n            const newData = await response.json();\n        } catch (error) {\n            console.error('Ошибка при разблокировке пользователя:', error);\n        }\n        setIsModalOpen(false);\n        window.location.reload();\n    };\n    const isCurator = value4[0]?.role === 'curator';\n    const isCurrentUserCurator = value2[0]?.curator === value3;\n    const isAdmin = value4[0]?.role === 'admin';\n    const isUserBlocked = value3[0]?.user_exists_in_blocks === 1;\n    return (\n        <>\n        {(!isUserBlocked && isCurrentUserCurator) || (isAdmin && !isUserBlocked) && (\n            <>\n                {/* <button className=\"redactirovat\" onClick={handleEditClick}>Редактировать</button> */}\n                <button className=\"redactirovat\" onClick={handleBlockClick}>Заблокировать</button>\n            </>\n        )}\n         {isUserBlocked && (\n                <>\n                <h1 className=\"blocked-message2\">Пользователь заблокирован</h1> \n                <h1 className=\"blocked-message2\">Причина: {value3[0].block_reason}</h1> \n                </>\n            )}\n           {(isUserBlocked && isAdmin) && (\n            <>\n               \n                <button className=\"redactirovat2\" onClick={handleBlockClick}>Разблокировать</button>\n            </>\n        )}\n          {isModalOpen && (\n            <div className=\"modal-overlay3\">\n                <div className=\"modal3\">\n                    {isAdmin && isUserBlocked ? (\n                        <>\n                            <h2>Вы уверены, что хотите разблокировать пользователя?</h2>\n                            <button onClick={handleCloseModal}>Отмена</button>\n                            <button onClick={handleUnblockUser}>Разблокировать</button>\n                        </>\n                    ) : (\n                        <>\n                            <h2>Вы уверены, что хотите заблокировать пользователя?</h2>\n                            <input\n                                type=\"text\"\n                                placeholder=\"Введите причину блокировки\"\n                                onChange={(e) => setBlockReason(e.target.value)}\n                            />\n                            <button onClick={handleCloseModal}>Отмена</button>\n                            <button onClick={handleBlockUser}>Заблокировать</button>\n                        </>\n                    )}\n                </div>\n            </div>\n        )}\n        </>\n    )\n}\n\nexport default BlockUser;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}