{"ast":null,"code":"var _jsxFileName = \"/Applications/MAMP/htdocs/gitrepo/tourclubkz/my-react-app/src/Lessonlist.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { jwtDecode } from 'jwt-decode';\nimport { BrowserRouter as Router, Route, Link, Switch } from 'react-router-dom';\nimport Startnewcourse from './Startnewcourse';\nimport axios from \"axios\";\nimport LessonsPanel from './LessonsPanel';\nimport { BASE_URL } from './config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction LessonListPage() {\n  _s();\n  const [hasAccess, setHasAccess] = useState(true);\n  const {\n    title\n  } = useParams();\n  const navigate = useNavigate();\n  const titleWithSpaces = title.replace(/-/g, ' ');\n  const [responseData, setResponseData] = useState(null);\n  const [userRole, setUserRole] = useState(null);\n  const [data, setData] = useState([]);\n  const token = localStorage.getItem('token');\n  const decodedToken = jwtDecode(token);\n  const id = decodedToken.sub;\n  const fetchData = useCallback(async () => {\n    try {\n      const response = await axios.post(`${BASE_URL}tourschoolphp/lessonlist.php`, {\n        title: titleWithSpaces\n      });\n      if (!response.data) {\n        throw new Error('Пустой ответ от сервера');\n      }\n      setResponseData(response.data);\n    } catch (error) {\n      console.error('Ошибка при запросе данных:', error);\n    }\n  }, [titleWithSpaces]);\n  useEffect(() => {\n    const checkCourseAccess = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        const userId = token ? jwtDecode(token).sub : null;\n        const response = await axios.post(`${BASE_URL}tourschoolphp/checkCourseAccess.php`, {\n          user_id: userId,\n          course_name: titleWithSpaces\n        });\n        if (!response.data || response.data.length === 0) {\n          setHasAccess(false);\n          return;\n        }\n        fetchData();\n      } catch (error) {\n        console.error('Ошибка при проверке доступа:', error);\n      }\n    };\n    checkCourseAccess();\n  }, [titleWithSpaces, fetchData]);\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      setUserRole(jwtDecode(token).role);\n    }\n  }, [fetchData]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"connews\",\n    children: hasAccess ? responseData ? /*#__PURE__*/_jsxDEV(LessonsPanel, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 11\n    }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"\\u041F\\u0440\\u043E\\u0432\\u0435\\u0440\\u043A\\u0430 \\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u0430...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 11\n    }, this) : /*#__PURE__*/_jsxDEV(Startnewcourse, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n}\n_s(LessonListPage, \"Aw5fdPd+Yph/XrfDP+jcIheiq4M=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = LessonListPage;\nexport default LessonListPage;\nvar _c;\n$RefreshReg$(_c, \"LessonListPage\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useParams","useNavigate","jwtDecode","BrowserRouter","Router","Route","Link","Switch","Startnewcourse","axios","LessonsPanel","BASE_URL","jsxDEV","_jsxDEV","LessonListPage","_s","hasAccess","setHasAccess","title","navigate","titleWithSpaces","replace","responseData","setResponseData","userRole","setUserRole","data","setData","token","localStorage","getItem","decodedToken","id","sub","fetchData","response","post","Error","error","console","checkCourseAccess","userId","user_id","course_name","length","role","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Applications/MAMP/htdocs/gitrepo/tourclubkz/my-react-app/src/Lessonlist.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { jwtDecode } from 'jwt-decode';\nimport { BrowserRouter as Router, Route, Link, Switch } from 'react-router-dom';\nimport Startnewcourse from './Startnewcourse';\nimport axios from \"axios\";\nimport LessonsPanel from './LessonsPanel';\nimport { BASE_URL } from './config';\nfunction LessonListPage() {\n  const [hasAccess, setHasAccess] = useState(true);\n  const { title } = useParams();\n  const navigate = useNavigate();\n  const titleWithSpaces = title.replace(/-/g, ' ');\n  const [responseData, setResponseData] = useState(null);\n  const [userRole, setUserRole] = useState(null);\n  const [data, setData] = useState([]);\n  const token = localStorage.getItem('token');\n  const decodedToken = jwtDecode(token);\n  const id = decodedToken.sub;\n  const fetchData = useCallback(async () => {\n    try {\n      const response = await axios.post(`${BASE_URL}tourschoolphp/lessonlist.php`, {\n        title: titleWithSpaces,\n      });\n      \n      if (!response.data) {\n        throw new Error('Пустой ответ от сервера');\n      }\n      \n      setResponseData(response.data);\n      \n    } catch (error) {\n      console.error('Ошибка при запросе данных:', error);\n    }\n  }, [titleWithSpaces]);\n\n  useEffect(() => {\n    const checkCourseAccess = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        const userId = token ? jwtDecode(token).sub : null;\n\n        const response = await axios.post(`${BASE_URL}tourschoolphp/checkCourseAccess.php`, {\n          user_id: userId,\n          course_name: titleWithSpaces,\n        });\n\n        if (!response.data || response.data.length === 0) {\n         \n          setHasAccess(false);\n          return;\n        }\n\n        fetchData();\n      } catch (error) {\n        console.error('Ошибка при проверке доступа:', error);\n      }\n    };\n\n    checkCourseAccess();\n  }, [titleWithSpaces, fetchData]);\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      setUserRole(jwtDecode(token).role);\n    }\n  }, [fetchData]);\n\n  \n\n  return (\n    <div className='connews'>\n      {hasAccess ? (\n        responseData ? (\n          <LessonsPanel />\n        ) : (\n          <p>Проверка доступа...</p>\n        )\n      ) : (\n        <Startnewcourse />\n      )}\n    </div>\n  );\n}\n\nexport default LessonListPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}