{"ast":null,"code":"// src/components/PrivateRoute.js\nimport React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{jwtDecode}from'jwt-decode';import{BASE_URL}from'./config';const AdminRoute=_ref=>{let{children}=_ref;const[isAdmin,setIsAdmin]=useState(false);const token=localStorage.getItem('token');const decodedToken=jwtDecode(token);const id=decodedToken.sub;const navigate=useNavigate();useEffect(()=>{const checkUserStatus=async()=>{try{const response=await fetch(\"\".concat(BASE_URL,\"tourschoolphp/checkUserAdmin.php\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({id})});if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();if(data.status==='active'&&data.role==='admin'){// User is an admin\nsetIsAdmin(true);}else{// User is not an admin or other error\nsetIsAdmin(false);console.error('Error in checkUserStatus:',data.error);// Redirect to '/courses' if the user is not an admin\nnavigate('/courses');}}catch(error){console.error('An error occurred while checking user status:',error);}};if(token){checkUserStatus();// Check user status when the component loads\n}else{navigate('/');// If there is no token, navigate to the home page\n}},[token,navigate,id]);return isAdmin?children:null;};export default AdminRoute;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","jwtDecode","BASE_URL","AdminRoute","_ref","children","isAdmin","setIsAdmin","token","localStorage","getItem","decodedToken","id","sub","navigate","checkUserStatus","response","fetch","concat","method","headers","body","JSON","stringify","ok","Error","status","data","json","role","console","error"],"sources":["/Applications/MAMP/htdocs/gitrepo/tourclubkz/my-react-app/src/Adminroute.js"],"sourcesContent":["// src/components/PrivateRoute.js\n\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { jwtDecode } from 'jwt-decode';\nimport { BASE_URL } from './config';\nconst AdminRoute = ({ children }) => {\n  const [isAdmin, setIsAdmin] = useState(false);\n  const token = localStorage.getItem('token');\n  const decodedToken = jwtDecode(token);\n  const id = decodedToken.sub;\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const checkUserStatus = async () => {\n      try {\n        const response = await fetch(`${BASE_URL}tourschoolphp/checkUserAdmin.php`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({ id }),\n        });\n\n        if (!response.ok) {\n          throw new Error(`HTTP error! status: ${response.status}`);\n        }\n\n        const data = await response.json();\n\n        if (data.status === 'active' && data.role === 'admin') {\n          // User is an admin\n          setIsAdmin(true);\n        } else {\n          // User is not an admin or other error\n          setIsAdmin(false);\n          console.error('Error in checkUserStatus:', data.error);\n\n          // Redirect to '/courses' if the user is not an admin\n          navigate('/courses');\n        }\n      } catch (error) {\n        console.error('An error occurred while checking user status:', error);\n      }\n    };\n\n    if (token) {\n      checkUserStatus(); // Check user status when the component loads\n    } else {\n      navigate('/'); // If there is no token, navigate to the home page\n    }\n  }, [token, navigate, id]);\n\n  return isAdmin ? children : null;\n};\n\nexport default AdminRoute;\n"],"mappings":"AAAA;AAEA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,SAAS,KAAQ,YAAY,CACtC,OAASC,QAAQ,KAAQ,UAAU,CACnC,KAAM,CAAAC,UAAU,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAC9B,KAAM,CAACE,OAAO,CAAEC,UAAU,CAAC,CAAGR,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAAAS,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAAAC,YAAY,CAAGV,SAAS,CAACO,KAAK,CAAC,CACrC,KAAM,CAAAI,EAAE,CAAGD,YAAY,CAACE,GAAG,CAC3B,KAAM,CAAAC,QAAQ,CAAGd,WAAW,CAAC,CAAC,CAE9BF,SAAS,CAAC,IAAM,CACd,KAAM,CAAAiB,eAAe,CAAG,KAAAA,CAAA,GAAY,CAClC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,IAAAC,MAAA,CAAIhB,QAAQ,qCAAoC,CAC1EiB,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEX,EAAG,CAAC,CAC7B,CAAC,CAAC,CAEF,GAAI,CAACI,QAAQ,CAACQ,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAC,KAAK,wBAAAP,MAAA,CAAwBF,QAAQ,CAACU,MAAM,CAAE,CAAC,CAC3D,CAEA,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAX,QAAQ,CAACY,IAAI,CAAC,CAAC,CAElC,GAAID,IAAI,CAACD,MAAM,GAAK,QAAQ,EAAIC,IAAI,CAACE,IAAI,GAAK,OAAO,CAAE,CACrD;AACAtB,UAAU,CAAC,IAAI,CAAC,CAClB,CAAC,IAAM,CACL;AACAA,UAAU,CAAC,KAAK,CAAC,CACjBuB,OAAO,CAACC,KAAK,CAAC,2BAA2B,CAAEJ,IAAI,CAACI,KAAK,CAAC,CAEtD;AACAjB,QAAQ,CAAC,UAAU,CAAC,CACtB,CACF,CAAE,MAAOiB,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,+CAA+C,CAAEA,KAAK,CAAC,CACvE,CACF,CAAC,CAED,GAAIvB,KAAK,CAAE,CACTO,eAAe,CAAC,CAAC,CAAE;AACrB,CAAC,IAAM,CACLD,QAAQ,CAAC,GAAG,CAAC,CAAE;AACjB,CACF,CAAC,CAAE,CAACN,KAAK,CAAEM,QAAQ,CAAEF,EAAE,CAAC,CAAC,CAEzB,MAAO,CAAAN,OAAO,CAAGD,QAAQ,CAAG,IAAI,CAClC,CAAC,CAED,cAAe,CAAAF,UAAU","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}