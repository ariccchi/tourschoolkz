{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{jwtDecode}from'jwt-decode';import{useParams}from'react-router-dom';import'./sumresult.css';import{BASE_URL}from'./config';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function SumResult(){const{title}=useParams();const titleWithSpaces=title.replace(/-/g,' ');const token=localStorage.getItem('token');let decoded=jwtDecode(token);let user_id=decoded.sub;const[resultData,setResultData]=useState([]);useEffect(()=>{const checkResultAndShowVideo=async()=>{try{const checkResultResponse=await axios.post(\"\".concat(BASE_URL,\"tourschoolphp/resultpage.php\"),{user_id:user_id,title:titleWithSpaces});const responseData=checkResultResponse.data||[];console.log('Received data:',responseData);setResultData(responseData);}catch(error){console.error('Error checking result and showing video:',error);}};checkResultAndShowVideo();},[user_id,titleWithSpaces]);// Вычисление среднего процента\nconst calculateAveragePercentage=()=>{if(!Array.isArray(resultData)||resultData.length===0){return 0;}const totalPercentage=resultData.reduce((sum,result)=>{const resultValue=parseInt(result.result);return isNaN(resultValue)?sum:sum+resultValue;},0);const average=totalPercentage/resultData.length;return average.toFixed(2);};const averagePercentage=calculateAveragePercentage();return/*#__PURE__*/_jsx(\"div\",{className:\"fullpage2\",children:!Array.isArray(resultData)||resultData.length===0||resultData.error?/*#__PURE__*/_jsx(\"div\",{className:\"no-results-message\",children:\"\\u0412\\u044B \\u043D\\u0435 \\u043F\\u0440\\u043E\\u0448\\u043B\\u0438 \\u043D\\u0438 \\u043E\\u0434\\u043D\\u043E\\u0433\\u043E \\u0443\\u0440\\u043E\\u043A\\u0430\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"ResultsFull\",children:resultData.map(result=>/*#__PURE__*/_jsxs(\"div\",{className:\"lessonblock2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"LessonTitle2\",children:result.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"lessonfinres\",children:[result.result,\"%\"]})]},result.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"roundsummary2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"roundprocent2\",children:[averagePercentage,\"%\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"roundprocenth2\",children:\"\\u0412\\u0430\\u0448 \\u0441\\u0440\\u0435\\u0434\\u043D\\u0438\\u0439 \\u043F\\u0440\\u043E\\u0446\\u0435\\u043D\\u0442 \"})]})]})});}export default SumResult;","map":{"version":3,"names":["React","useState","useEffect","axios","jwtDecode","useParams","BASE_URL","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SumResult","title","titleWithSpaces","replace","token","localStorage","getItem","decoded","user_id","sub","resultData","setResultData","checkResultAndShowVideo","checkResultResponse","post","concat","responseData","data","console","log","error","calculateAveragePercentage","Array","isArray","length","totalPercentage","reduce","sum","result","resultValue","parseInt","isNaN","average","toFixed","averagePercentage","className","children","map","id"],"sources":["/Applications/MAMP/htdocs/gitrepo/tourclubkz/my-react-app/src/result.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { jwtDecode } from 'jwt-decode';\nimport { useParams } from 'react-router-dom';\nimport './sumresult.css';\nimport { BASE_URL } from './config';\n\nfunction SumResult() {\n  const { title } = useParams();\n  const titleWithSpaces = title.replace(/-/g, ' '); \n  const token = localStorage.getItem('token');\n  let decoded = jwtDecode(token);\n  let user_id = decoded.sub;\n\n  const [resultData, setResultData] = useState([]);\n\n  useEffect(() => {\n    const checkResultAndShowVideo = async () => {\n      try {\n        const checkResultResponse = await axios.post(`${BASE_URL}tourschoolphp/resultpage.php`, {\n          user_id: user_id,\n          title: titleWithSpaces,\n        });\n  \n        const responseData = checkResultResponse.data || [];\n        console.log('Received data:', responseData);\n  \n        setResultData(responseData);\n      } catch (error) {\n        console.error('Error checking result and showing video:', error);\n      }\n    };\n  \n    checkResultAndShowVideo();\n  }, [user_id, titleWithSpaces]);\n\n  // Вычисление среднего процента\n  const calculateAveragePercentage = () => {\n    if (!Array.isArray(resultData) || resultData.length === 0) {\n      return 0;\n    }\n  \n    const totalPercentage = resultData.reduce((sum, result) => {\n      const resultValue = parseInt(result.result);\n      return isNaN(resultValue) ? sum : sum + resultValue;\n    }, 0);\n  \n    const average = totalPercentage / resultData.length;\n  \n    return average.toFixed(2);\n  };\n  \n  \n  const averagePercentage = calculateAveragePercentage();\n  \n  return (\n    <div className='fullpage2'>\n   {(!Array.isArray(resultData) || resultData.length === 0 || resultData.error) ? (\n  <div className='no-results-message'>Вы не прошли ни одного урока</div>\n) : (\n  <>  \n          <div className='ResultsFull'>\n            {resultData.map((result) => (\n              <div key={result.id} className='lessonblock2'>\n                <div className='LessonTitle2'>{result.title}</div>\n                <div className='lessonfinres'>{result.result}%</div>\n              </div>\n            ))}\n          </div>\n          <div className=\"roundsummary2\">\n            <div className=\"roundprocent2\">{averagePercentage}%</div>\n            <div className=\"roundprocenth2\">Ваш средний процент </div>\n          </div>\n     </>\n      )}\n    </div>\n  );\n}\n\nexport default SumResult;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,SAAS,KAAQ,YAAY,CACtC,OAASC,SAAS,KAAQ,kBAAkB,CAC5C,MAAO,iBAAiB,CACxB,OAASC,QAAQ,KAAQ,UAAU,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAEpC,QAAS,CAAAC,SAASA,CAAA,CAAG,CACnB,KAAM,CAAEC,KAAM,CAAC,CAAGT,SAAS,CAAC,CAAC,CAC7B,KAAM,CAAAU,eAAe,CAAGD,KAAK,CAACE,OAAO,CAAC,IAAI,CAAE,GAAG,CAAC,CAChD,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAI,CAAAC,OAAO,CAAGhB,SAAS,CAACa,KAAK,CAAC,CAC9B,GAAI,CAAAI,OAAO,CAAGD,OAAO,CAACE,GAAG,CAEzB,KAAM,CAACC,UAAU,CAAEC,aAAa,CAAC,CAAGvB,QAAQ,CAAC,EAAE,CAAC,CAEhDC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAuB,uBAAuB,CAAG,KAAAA,CAAA,GAAY,CAC1C,GAAI,CACF,KAAM,CAAAC,mBAAmB,CAAG,KAAM,CAAAvB,KAAK,CAACwB,IAAI,IAAAC,MAAA,CAAItB,QAAQ,iCAAgC,CACtFe,OAAO,CAAEA,OAAO,CAChBP,KAAK,CAAEC,eACT,CAAC,CAAC,CAEF,KAAM,CAAAc,YAAY,CAAGH,mBAAmB,CAACI,IAAI,EAAI,EAAE,CACnDC,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAEH,YAAY,CAAC,CAE3CL,aAAa,CAACK,YAAY,CAAC,CAC7B,CAAE,MAAOI,KAAK,CAAE,CACdF,OAAO,CAACE,KAAK,CAAC,0CAA0C,CAAEA,KAAK,CAAC,CAClE,CACF,CAAC,CAEDR,uBAAuB,CAAC,CAAC,CAC3B,CAAC,CAAE,CAACJ,OAAO,CAAEN,eAAe,CAAC,CAAC,CAE9B;AACA,KAAM,CAAAmB,0BAA0B,CAAGA,CAAA,GAAM,CACvC,GAAI,CAACC,KAAK,CAACC,OAAO,CAACb,UAAU,CAAC,EAAIA,UAAU,CAACc,MAAM,GAAK,CAAC,CAAE,CACzD,MAAO,EAAC,CACV,CAEA,KAAM,CAAAC,eAAe,CAAGf,UAAU,CAACgB,MAAM,CAAC,CAACC,GAAG,CAAEC,MAAM,GAAK,CACzD,KAAM,CAAAC,WAAW,CAAGC,QAAQ,CAACF,MAAM,CAACA,MAAM,CAAC,CAC3C,MAAO,CAAAG,KAAK,CAACF,WAAW,CAAC,CAAGF,GAAG,CAAGA,GAAG,CAAGE,WAAW,CACrD,CAAC,CAAE,CAAC,CAAC,CAEL,KAAM,CAAAG,OAAO,CAAGP,eAAe,CAAGf,UAAU,CAACc,MAAM,CAEnD,MAAO,CAAAQ,OAAO,CAACC,OAAO,CAAC,CAAC,CAAC,CAC3B,CAAC,CAGD,KAAM,CAAAC,iBAAiB,CAAGb,0BAA0B,CAAC,CAAC,CAEtD,mBACE1B,IAAA,QAAKwC,SAAS,CAAC,WAAW,CAAAC,QAAA,CACzB,CAACd,KAAK,CAACC,OAAO,CAACb,UAAU,CAAC,EAAIA,UAAU,CAACc,MAAM,GAAK,CAAC,EAAId,UAAU,CAACU,KAAK,cAC5EzB,IAAA,QAAKwC,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CAAC,iJAA4B,CAAK,CAAC,cAEtEvC,KAAA,CAAAE,SAAA,EAAAqC,QAAA,eACQzC,IAAA,QAAKwC,SAAS,CAAC,aAAa,CAAAC,QAAA,CACzB1B,UAAU,CAAC2B,GAAG,CAAET,MAAM,eACrB/B,KAAA,QAAqBsC,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3CzC,IAAA,QAAKwC,SAAS,CAAC,cAAc,CAAAC,QAAA,CAAER,MAAM,CAAC3B,KAAK,CAAM,CAAC,cAClDJ,KAAA,QAAKsC,SAAS,CAAC,cAAc,CAAAC,QAAA,EAAER,MAAM,CAACA,MAAM,CAAC,GAAC,EAAK,CAAC,GAF5CA,MAAM,CAACU,EAGZ,CACN,CAAC,CACC,CAAC,cACNzC,KAAA,QAAKsC,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BvC,KAAA,QAAKsC,SAAS,CAAC,eAAe,CAAAC,QAAA,EAAEF,iBAAiB,CAAC,GAAC,EAAK,CAAC,cACzDvC,IAAA,QAAKwC,SAAS,CAAC,gBAAgB,CAAAC,QAAA,CAAC,2GAAoB,CAAK,CAAC,EACvD,CAAC,EACT,CACA,CACE,CAAC,CAEV,CAEA,cAAe,CAAApC,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}